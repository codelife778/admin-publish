(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07d1738b"],{"1b62":function(e,t,r){"use strict";var s=r("5f87");t["a"]={data:function(){return{page:{currentPage:1,size:10,total:0,pageSizes:[5,10,30,40]},loadingOption:{background:"rgba(255,255,255,.9)",text:"loading.....",spinner:"el-icon-loading"},uploadUrl:"http://localhost/lejuAdmin/material/uploadFileOss"}},computed:{headers:function(){var e=Object(s["a"])(),t={token:e};return t}}}},"3e6f":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[r("div",[r("el-form",{ref:"form",attrs:{model:e.search,"label-width":"80px",inline:!1,size:"mini"}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"昵称"}},[r("el-input",{attrs:{placeholder:"昵称模糊搜索",size:"mini",clearable:""},model:{value:e.search.nickName,callback:function(t){e.$set(e.search,"nickName",t)},expression:"search.nickName"}})],1)],1),r("el-col",{attrs:{span:6,offset:0}},[r("el-form-item",{attrs:{label:"用户名",size:"mini",prop:"username"}},[r("el-input",{attrs:{placeholder:"用户名模糊搜索",size:"mini",clearable:""},model:{value:e.search.username,callback:function(t){e.$set(e.search,"username",t)},expression:"search.username"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6,offset:18}},[r("el-button",{attrs:{type:"default",size:"mini"},on:{click:e.doReset}},[e._v("重置")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.doSearch}},[e._v("查询")])],1)],1)],1)],1)]),r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("el-button",{attrs:{type:"primary"},on:{click:e.toAdd}},[e._v("新增")])],1),r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index",label:"#",width:"width"}}),r("el-table-column",{attrs:{align:"center",prop:"username",label:"用户名",width:"200"}}),r("el-table-column",{attrs:{align:"center",prop:"nick_name",label:"昵称",width:"200"}}),r("el-table-column",{attrs:{align:"center",prop:"prop",label:"用户头像",width:"200"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.salt,alt:""}})]}}])}),r("el-table-column",{attrs:{align:"center",label:"角色",prop:"roles",width:"150"}}),r("el-table-column",{attrs:{label:"添加时间",align:"center",prop:"create_time",width:"200"}}),r("el-table-column",{attrs:{align:"center",prop:"prop",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(r){return e.toEditor(t.row.id)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return e.toDelete(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),r("el-pagination",{staticStyle:{"margin-top":"30px","text-align":"right"},attrs:{"current-page":e.page.currentPage,"page-sizes":e.page.pageSizes,"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1),r("Popup",{ref:"popup",on:{refresh:e.getAccountList}})],1)},a=[],o=r("51d8"),n=r("1b62"),l=r("5d6d"),i={name:"",components:{Popup:l["default"]},mixins:[n["a"]],data:function(){return{search:{nickName:"",username:""},userList:[]}},created:function(){this.getAccountList()},methods:{currentChange:function(e){this.page.currentPage=e,this.getAccountList()},sizeChange:function(e){this.page.size=e,this.page.currentPage=1,this.getAccountList()},toAdd:function(){this.$refs.popup.openPopup()},toEditor:function(e){this.$refs.popup.openPopup(e)},toDelete:function(e){var t=this;this.$confirm("确认删除?").then((function(r){o["a"].removeUser(e).then((function(e){e.success?(t.$message.success("删除成功!"),t.getAccountList()):t.$message.error(e.message)}))})).catch((function(){t.$message.info("已取消")}))},doReset:function(){},doSearch:function(){},getAccountList:function(){var e=this;o["a"].findUsersByPage(1,10).then((function(t){console.log("res: ",t),t.success?(e.userList=t.data.rows,e.page.total=t.data.total):e.$message.error("获取信息失败")})).catch((function(e){}))}}},c=i,u=r("0b56"),d=Object(u["a"])(c,s,a,!1,null,"80d887a8",null);t["default"]=d.exports},"51d8":function(e,t,r){"use strict";r("151b");var s=r("b775");function a(e,t,r){return Object(s["a"])({url:"/admin/sysAuth/user/findUsersByPage/".concat(e,"/").concat(t),method:"post",data:r})}function o(e){return Object(s["a"])({url:"/admin/sysAuth/user/removeUser/".concat(e),method:"delete"})}function n(e){return Object(s["a"])({url:"/admin/sysAuth/user/saveUserRoles",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/admin/sysAuth/user/".concat(e)})}function i(e){return Object(s["a"])({url:"/admin/sysAuth/user/updateUserRoles",method:"put",data:e})}function c(){return Object(s["a"])({url:"/admin/sysAuth/role/findAllRoles"})}t["a"]={findUsersByPage:a,removeUser:o,saveUserRoles:n,user:l,updateUserRoles:i,findAllRoles:c}},"5d6d":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"编辑用户",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[r("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px",inline:!1,size:"normal"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{readonly:e.form.id&&e.form.id.length>0,size:"small"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),r("el-form-item",{attrs:{label:"用户昵称",prop:"nickName"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}})],1),e.form.id?e._e():r("el-form-item",{attrs:{label:"密码"}},[r("el-input",{attrs:{type:"password",size:"small"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("el-form-item",{attrs:{label:"用户头像"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://localhost/lejuAdmin/material/uploadFileOss",headers:e.headers,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[r("el-avatar",{attrs:{icon:"el-icon-user-solid",src:e.form.salt}})],1)],1),r("el-form-item",{attrs:{label:"选择角色",prop:"username"}},[r("el-select",{attrs:{size:"small","value-key":"id",clearable:"",multiple:""},model:{value:e.form.roleIds,callback:function(t){e.$set(e.form,"roleIds",t)},expression:"form.roleIds"}},e._l(e.roleList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确 定")])],1)],1)],1)},a=[],o=(r("f3b4"),r("b19d"),r("51d8")),n={name:"",data:function(){return{dialogVisible:!1,form:{id:"",salt:"",roleIds:[]},roleList:[],rules:{username:[{required:!0,message:"用户名名称不能为空",trigger:"blur"}],nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}}},computed:{headers:function(){return{token:localStorage.getItem("token")}}},methods:{handleClose:function(){this.dialogVisible=!1,this.form={}},handleAvatarSuccess:function(e,t){console.log(e),e.success?this.form.salt=e.data.fileUrl:this.$message.error(e.message)},beforeAvatarUpload:function(e){var t=/image\/(jpeg|png|gif|webp)/gi,r=t.test(e.type),s=e.size/1024/1024<2;return r||this.$message.error("上传头像图片只能是 jpeg|png|gif|webp 格式!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&s},openPopup:function(e){var t=this;this.dialogVisible=!0,o["a"].findAllRoles().then((function(e){t.roleList=e.data.items})),e&&(this.treeLoad=!0,o["a"].user(e).then((function(e){e.success?t.form=e.data.user:t.$message.error("查询失败!")})))},onSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$message.error("请注意表单验证!"),!1;var r=null;r=e.form.id?o["a"].updateUserRoles:o["a"].saveUserRoles,r(e.form).then((function(t){t.success?(e.$message.success("保存成功!"),e.handleClose(),e.$emit("refresh")):e.$message.error(t.message)}))}))}}},l=n,i=r("0b56"),c=Object(i["a"])(l,s,a,!1,null,"269324e0",null);t["default"]=c.exports}}]);